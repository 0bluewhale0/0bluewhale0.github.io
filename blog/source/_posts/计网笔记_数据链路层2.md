---
title: 计网笔记-数据链路层2
date: 2022-04-06 10:46:00
categories:
	- 笔记
tags:
	- course
	- 计网
toc: true
cover: /img/88050604_p0_master1200.jpg
---

上一个太长了，再分一个

## 3.4滑动窗口协议

英文是：
**Sliding Window**

### 捎带应答Piggy backing

<font size=1>查了一下piggy的意思是贪心的，🐷🐷风评被害</font>
就是说俩边不停的来回发，（全双工），就可以把ACK信息放在sck field里面，跟着另一方的回复发回去。

### 发送/接收窗口Sending window & Receiving window

发送窗口维护一组序号，一个时间对应一组可以发送的序号
接收窗口同理，维护的是一组可以接受的信号。接收窗口大于1的时候，落在接收窗口的帧不能马上接受，需要把没按顺序到达的帧先存起来。

几种协议：（由简到繁，由最简单的调整参数就可以依次实现）

- A **One-Bit** Sliding Window Protocol 实际上就是停等协议
- A Protocol Using **Go Back N**  GBN协议
- A Protocol Using **Selective Repeat** SR协议

### 单bit的滑动窗口协议

**Protocol 4**
发送窗口==接收窗口
![单bit](https://api2.mubu.com/v3/document_image/88477f43-1e79-488e-8992-db2a956bad4a-16175743.jpg)
A sliding window of size 1, with a 3-bit sequence number.
窗口关闭的意思是没有帧在发送
(a) 初始状态
(b) 第一个帧发送完成
(c) 第一个帧已经被接收
(d) 第一个ACK被接收

课本上的代码在[这里1](https://api2.mubu.com/v3/document_image/9d4c339e-0bfa-4e7d-9f5e-d9b655f187a5-16175743.jpg)以及[这里2](https://api2.mubu.com/v3/document_image/b9392d86-a6db-4331-968c-4a485dca220f-16175743.jpg)
<font size=1>gzc说实际工程里的发送方的序号是期望收到的序号，但是课本上不是，whatever，👴不懂</font>

- 关于line utilization（线路利用）
  👴自己的理解大概就是<font color=blue>
  $\frac{发送端在发送消息的时间}{消息到达并收到ACK的时间}$</font>
  其中
  <font size=2 color=blue>消息到达并收到ACK的时间=发送消息的时间+传播(propagation)延迟$\times2$</font>
- 单bit滑动窗口协议的问题就在于<u>线路利用率太低了</u>

### Go Back N 协议

**Protocol 5**
![](https://api2.mubu.com/v3/document_image/70054526-d907-4673-b4b6-1088c625507a-16175743.jpg)



### SR协议Selective Repeat/Reject

**Protocol 6**

#### 关于滑动窗口的数量

Ws：sender window
Wr: reciver window
他们的数量关系满足以下式子：
>Ws+Wr <=2n
 Ws>=Wr
可以推出：
 Ws,Wr<= 2n -1

课本上的代码在[这里1](https://api2.mubu.com/v3/document_image/596a271d-196c-44b1-acbc-ca15be42618d-16175743.jpg),[这里2](https://api2.mubu.com/v3/document_image/89628c93-471f-411e-923b-7df2be7b36bc-16175743.jpg),[这里3](https://api2.mubu.com/v3/document_image/7a115cd0-ad06-4e6b-8d04-d797d631eeee-16175743.jpg)以及[这里4](https://api2.mubu.com/v3/document_image/d601ad65-c489-47e6-8273-f64e9c9ba542-16175743.jpg)

#### 关于line utilization（gzc的official理解）

当sender只有一个窗口时，也就是单bit的滑动窗口时，示意图如下。（分为a，b两种情况，从上往下为时间推进方向）
![official理解](https://api2.mubu.com/v3/document_image/6679fb30-043e-4701-8fef-a1b044dfd208-16175743.jpg)

$\alpha=\cfrac{t_p}{t_f}$ ，  $t_p$即propagation time，传输时延，$t_f$是发送时延。
这里的$\alpha$其实就是sender和reciver之间可以放得下几个Frame。

当sender有W个窗口的时候就是这么个状态
![W个窗口](https://api2.mubu.com/v3/document_image/9b174992-5855-4a4e-b9e7-57f4c0ea5def-16175743.jpg)
常见介质中的信号传播速度
![](https://api2.mubu.com/v3/document_image/750a9a07-002d-4976-aa20-024e882846e0-16175743.jpg)

>throughput:吞吐量=利用率*带宽



## 3.5数据链路层协议实例


